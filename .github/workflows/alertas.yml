name: Alertas Contralys Diarias

on:
  schedule:
    - cron: "0 8 * * *"  # 08:00 UTC diario
  workflow_dispatch:

jobs:
  run-alerts:
    runs-on: ubuntu-latest

    steps:
      - name: Llamar endpoint de alertas y mostrar respuesta
        run: |
          echo "========================================="
          echo "Iniciando ejecuci√≥n del cron Contralys"
          echo "URL: ${{ secrets.ALERTS_URL }}"
          echo "========================================="

          RESPONSE=$(curl -sS -X POST "${{ secrets.ALERTS_URL }}" \
            -H "X-Cron-Secret: ${{ secrets.CRON_SECRET }}")

          echo "Respuesta del servidor:"
          echo "$RESPONSE"

          echo "========================================="
          echo "Fin del cron"
          echo "========================================="
