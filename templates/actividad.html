<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Actividad completa</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
  background:#1e2430;
  color:#e5e7eb;
}

.container{
  max-width:1100px;
  margin:40px auto;
  padding:0 20px;
}

h1{
  font-size:22px;
  margin-bottom:20px;
}

.card{
  background:#252c3b;
  border-radius:14px;
  padding:20px;
  border:1px solid #374151;
}

table{
  width:100%;
  border-collapse:collapse;
}

th,td{
  padding:12px 10px;
  border-bottom:1px solid #374151;
  font-size:13px;
  text-align:left;
}

th{
  font-size:11px;
  text-transform:uppercase;
  color:#9ca3af;
}

.badge{
  padding:5px 10px;
  border-radius:999px;
  font-size:11px;
  background:#2d3547;
}

a{
  color:#3b82f6;
  text-decoration:none;
  font-weight:600;
}
</style>
</head>

<body>

<div class="container">

  <h1>Actividad completa</h1>
  <div style="color:#9ca3af;font-size:13px;margin-top:-10px;margin-bottom:18px;">
    Mostrando {{ (page-1)*25 + 1 }}–{{ (page-1)*25 + (actividad|length) }} de {{ total_registros }} eventos
  </div>

  <a href="/" style="display:inline-block;margin:10px 0 14px;color:#3b82f6;font-weight:700;text-decoration:none;">
     ← Volver al dashboard
  </a>

  <div class="card">

    <table>
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Usuario</th>
          <th>Acción</th>
          <th>Detalle</th>
        </tr>
      </thead>

      <tbody>
        {% for a in actividad %}
        <tr>
          <td>{{ (a.created_at|string)[:19].replace('T',' ') }}</td>
          <td><b>{{ a.actor_username }}</b></td>
          <td><span class="badge">{{ a.action }}</span></td>
          <td>{{ a.entity_type }} {{ a.entity_id or "" }}</td>
        </tr>
        {% endfor %}
      </tbody>

    </table>

    {# si no te llega page_size, ponemos 25 por defecto #}
    {% set page_size = page_size or 25 %}

    <div style="display:flex;justify-content:space-between;margin-top:20px;align-items:center;">

      <!-- Anterior -->
      {% if page > 1 %}
        <a href="/actividad?page={{ page - 1 }}"
           style="color:#3b82f6;font-weight:600;">
          ← Página anterior
        </a>
      {% else %}
        <span style="color:#4b5563;">&nbsp;</span>
      {% endif %}

      <!-- Siguiente o fin -->
      {% if (page * page_size) < total_registros %}
        <a href="/actividad?page={{ page + 1 }}"
           style="color:#3b82f6;font-weight:600;">
          Página siguiente →
        </a>
      {% else %}
        <span style="color:#4b5563;font-weight:600;">
          Fin de resultados
        </span>
      {% endif %}

    </div>

  </div>

</div>

</body>
</html>
